%************************************************
% INTRODUCTION
%************************************************

\chapter{Introduction} \label{chap: introduction}

\paragraph{Epilepsy} Epilepsy is a neurological disorder characterized by epileptic seizures \cite{NEJM:epilepsy}\cite{Epilepsia:epilepsy}, which are episodes of vigorous shaking. Each shaking episode can last from brief to long periods and it can result in physical injuries. In epilepsy, seizures tend to recur without warning or any immediate underlying cause; for this reason, people with epilepsy experience varying degrees of discomfort in their social life due to their condition \cite{WHO:epilepsy}.

The cause of most cases of epilepsy is unknown. Some cases can be due to brain injury, infections or tumours; other manifestations of the disorder are directly linked to genetic mutations; but the majority of cases do not present any evident causes \cite{WHO:epilepsy}. Epileptic seizures are the result of excessive and abnormal neuronal activity in the cortex of the brain \cite{Epilepsia:epilepsy}; they are diagnosed by excluding other conditions that might cause similar symptoms. Epilepsy can often be confirmed with an \acf{eeg}, but a normal test does not rule out the condition \cite{Hpim:seizuresandepilepsy}. Not all cases of epilepsy are lifelong, and many people improve to the point that treatment is no longer needed \cite{WHO:epilepsy}.

Seizures are controllable with medication in about 70\% of cases \cite{ERN:treatmentofepilepsy}. For people that do not respond to medication, surgery may be considered, but it is only an option when the area of the brain that causes the seizures can be clearly identified and is not responsible for critical functions. The condition of people that do not respond to medication is called \textit{drug-resistant epilepsy} (\acs{dre}) and people suffering of this situation are forced to deal with it in everyday life \cite{Epilepsia:DRE}.

Drug-resistant epilepsy is defined as failure of adequate trials of two tolerated and appropriately chosen and used antiepileptic drugs (AED schedules) to achieve sustained seizure freedom \cite{Epilepsia:DRE}. The probability that, after two failed AEDs, the next medication will achieve seizure freedom is around 4\% \cite{NEJM:DRE}. It is important that people with DRE undergo other treatments to control seizures, like neurostimulation or diet.

Approximately 50 million people currently live with epilepsy worldwide, which corresponds to about 0.65\% of the world population. Globally, an estimated 2.4 million people are diagnosed with epilepsy each year. This chronic disorder of the brain affects people of all ages and it is one of the most common neurological diseases globally. Approximately 30\% of people with epilepsy have a drug-resistant form, which corresponds to about 15 million of people \cite{WHO:epilepsy}.

People with epilepsy and especially those suffering from \acs{dre}, as a result of the frequent epileptic seizures, are subject to social discrimination and discomfort, which is often more difficult to overcome than the seizures themselves. The prejudice due to the disorder can even discourage people from seeking treatment for symptoms, so as to avoid becoming identified with the disorder \cite{WHO:epilepsy}.

\paragraph{Machine Learning} Nowadays, there exist machine learning techniques that could be applied to improve the everyday-life quality of people suffering from drug-resistant epilepsy. Research on the application of machine learning to epilepsy could also lead to a possible contribute for a study in the medical field in order to understand better the causes of epileptic seizures.

Machine learning (\acs{ml}) is a sub-field of artificial intelligence (\acs{ai}): while artificial intelligence studies are focused on the creations of machines that can mimic a human mind, the main aim of machine learning is to create machines that are able to perform a specific task. The difference from classic programs is that, to learn performing the task, a machine learning model automatically and progressively improve itself and its performance by analyzing sample data (called \textit{training data}), finding patterns and deriving a mathematical model from that. More formally, a machine learning model learns from experience $E$ on a type of tasks $T$ and with a performance measure $P$ if its performance at solving tasks in $T$, together with the measure $P$, improves with experience $E$ \cite{McGraw:ml}. This allows the model to make predictions or decisions without being explicitly programmed to perform that task.

Machine learning techniques can solve a variety of different tasks, like regression, prediction, classification, clustering, dimension reduction, density estimation, and many others \cite{Springer:patternrecognitionandml}. These tasks fit with as many applications, like personal assistance, natural language processing, data security, healthcare, financial trading, marketing personalization, image recognition, anomaly detection, robotics and so on. Machine learning is also strongly related to mathematical fields like data mining, optimization, and statistics.

One of the reasons why machine learning models in general have been heavily used just in recent years and are continuing to grow can be identified in the technological development: only starting from the new millennium we dispose of machines that have the computational power that is needed for these type of techniques.

\paragraph{ML and medicine} In the last few years, machine learning techniques have been largely applied also to the medical field. Many machine learning start-ups are intensively working on healthcare solutions that could potentially help doctors to diagnose illness, make patients' lives much easier or offer information able to save lives.

In healthcare, there already exist several different applications of machine learning \cite{emerj:MLhealthcareapplication}. One of the most popular applications is the diagnosis in medical imaging, which makes great use of computer vision and pattern recognition techniques \cite{arXiv:medicalimg}. A machine learning model can be trained by feeding to it a dataset of images labelled with the corresponding disease, so that it can process the data and "learn" disease-specific patterns. In this way, when a new image is fed to the model, it is able to recognize if the disease is present or not, hopefully with a good accuracy. Another utilization of machine learning algorithm in the medical field is the suggestion of treatment ideas or options, based on the previous experience with the disease and the analysis of what worked before \cite{NCBI:treatmentsuggestion}. These information can help a doctor to make more informed decisions. Machine learning algorithms are used also for drug discovery in the pharmacy field \cite{ScienceDirect:drugdiscovery}, through the analysis and creation of new chemical compositions, and for robotic surgery \cite{ResearchGate:roboticsurgery}, allowing surgeons to manipulate robotics devices having great precision and reaching tight spaces.

\paragraph{ML and epilepsy} In the case of epileptic seizures, machine learning can be very useful if used for seizure prediction. Indeed, the ability to predict epileptic seizures could be essential mainly for two types of applications: the notification of the incoming seizure to the patient, or the anticipation of the seizure using neurostimulation in order to avoid it. In the first case, we could think about a case scenario in which a person suffering from epilepsy receives a notification on his phone warning him of an incoming seizure in 10 minutes. By being alerted by a notification, the person has the time to put himself in a safe state before the start of the seizure, in order to avoid any subsequent injury. This is an example in which machine learning does not help avoiding the actual problem, but it is very helpful in order to contain the subsequent damages. In the second case, the application of seizure prediction is even more interesting, because it is able to avoid the actual seizure occurrence. Indeed, some medical researches \cite{NCBI:Neurostimulation} have proved the effectiveness of neurostimulation in the treatment of epilepsy: there exist devices that can provide stimulation to the entire brain or to specific areas of the brain (the ones responsible for the seizures) in order to reduce the number of seizures over the years or to actually avoid the seizure. If applied to the seizure focus in advance, the neurostimulation is able to "block" a single occurrence of shaking; therefore the ability to predict a seizure some seconds before its beginning could allow the device to intervene in time and to avoid the episode \cite{EF:Neurostimulation}.

\paragraph{Previous approaches} The topic of epileptic seizures has been deeply analysed since the 1970s. Tests involving recordings of \acs{eeg} are used in order to look for the causes of epilepsy and to observe the brain activity during seizures to find patterns that make it predictable (\cite{LancetNeurol:Seizurelikelihood} \cite{CurrOpinNeurol:Preseizure}). The seizure prediction task has been initially approached using classic statistical tools, like probability, thresholds, correlation, Monte Carlo methods and even classic machine learning methods, like support vector machines (\acsp{svm}) or k-clustering (\cite{Brain:Longroad} \cite{JClinNeurophysiol:stateoftheart} \cite{IEEE:nonlineareeg} \cite{ClinicalNeurophysiology:chance} \cite{NeuroscienceMethod:therapeuticdevices} \cite{arXiv:VLSIBCISystem} \cite{ComputMathMethodsMed:mlmethods}). However, given the complexity of the problems, during the last few years several deep learning approaches have been proposed, involving Convolutional Neural Networks, LSTM Neural Networks, Generative Adversarial Networks and even Graph Deep Learning (\cite{CurrOpinNeurol:review} \cite{arXiv:earlyseizuredetection} \cite{IEEE:graphtheory} \cite{NeuralNetworks:cnn} \cite{arXiv:quantitativeanalysis} \cite{arXiv:gan}). The deep learning models were able to obtain acceptable results, but the capacity of the classifiers to predict future sample classes between seizure and non-seizure remains uncertain.

\paragraph{Our approach} This master thesis project presents a review of machine learning and deep learning methods for the epileptic seizure prediction task. The study is performed using intracranial electroencephalography data (\acs{ieeg}) and it contains the implementation of a variety of models, including the more recent and promising approaches for machine learning on graphs, in order to realize a comparison between different approaches for the problem of seizure prediction. We started by testing simple models on a baseline scenario of prediction, that is the detection based on a single time step. After that, we introduced the analysis of temporal dependencies by using more complex models on the detection task on a sequence. Finally, we tested the complex models on the prediction task, trying to anticipate future seizures using past sequences of data.

In this thesis we present our findings about the performance of the models we tested on the problem of seizure prediction and we propose some guidance on how to approach this problem in real-life situations, where few data are available. Actually, a very limited amount of data has been used to train the models for this project. The reason is that epileptic seizures data are particularly difficult to gather, since the process to obtain them is very long, expensive, and annoying for the patient. The utilization of the data also implies several ethical and privacy-related implications. Consequently, we intentionally used an extremely limited quantity of data in order to test the models on a realistic scenario and to see if they could obtain good results even using few data to learn from.

We conducted an experimental campaign using real-world intracranial electroencephalography (\acs{ieeg}) data. The dataset was collected from a single patient over the course of 24 hours, making it a challenging and true-to-life setting to study the performance of the different algorithms in a scenario of data scarcity. For this purpose, several methods have been tested: classic machine learning techniques such as Random Forests, Gradient Boosting and \acf{svm}, plus a Dense Neural Network have been used only for the detection task; while a \acf{cnn}, an \acs{lstm} Neural Network and some \acf{gnn} have been tested both on the detection and the prediction tasks. All the models results have been compared in order to find out which one works better and how far it is able to predict a seizure.

\paragraph{} The thesis is organized as follows: Chapter \ref{chap: background} gives a high-level overview of all the machine learning techniques used and the theory behind them and it also presents the state of the art for the problem at hand; Chapter \ref{chap: methods} briefly describes the work done for this project and how the machine learning methods have been used; Chapter \ref{chap: implementation} explains the implementation of the project and all the related technical details; finally Chapter \ref{chap: conclusion} draws the conclusions, making some final comments about the project and suggesting future works.

